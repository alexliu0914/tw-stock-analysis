# 📊 圖表功能說明

## ✨ 新增功能

已成功整合 **Chart.js** 圖表庫，為台股分析工具增加視覺化功能！

### 新增的圖表

1. **📈 價格與均線圖表**
   - 顯示收盤價走勢
   - 同時顯示 6 條費波那契均線（MA5/13/21/34/55/144）
   - 互動式圖例，可點擊顯示/隱藏特定線條
   - 滑鼠懸停顯示詳細數值

2. **📉 KD 指標圖表**
   - K值和D值走勢圖
   - 標示超買區（80）和超賣區（20）
   - 清楚顯示黃金交叉/死亡交叉

## 🎨 設計特色

### 視覺效果
- ✨ **深色主題** - 與整體應用風格一致
- 🌈 **色彩編碼** - 每條均線使用不同顏色，易於區分
- 💫 **流暢動畫** - 圖表載入時有平滑的動畫效果
- 📱 **響應式設計** - 自動適應不同螢幕尺寸

### 互動功能
- 🖱️ **懸停提示** - 滑鼠移到圖表上顯示詳細數值
- 👆 **圖例控制** - 點擊圖例可顯示/隱藏特定線條
- 🔍 **縮放平移** - 支援觸控縮放（手機）
- 📊 **數據標籤** - 清楚標示每個數據點

## 📁 新增檔案

### charts.js
圖表管理模組，包含以下功能：

```javascript
// 主要函數
updatePriceChart(data)    // 更新價格圖表
updateKDChart(data)       // 更新KD圖表
clearCharts()             // 清除所有圖表
```

### 修改的檔案

1. **index.html**
   - 新增 Chart.js CDN 連結
   - 新增圖表 canvas 元素
   - 新增 charts.js 腳本引用

2. **styles.css**
   - 新增圖表容器樣式
   - 響應式圖表佈局
   - 深色主題配色

3. **analysis.js**
   - 新增 chartData 物件
   - 包含最近30天的價格和指標數據
   - 格式化日期標籤

4. **app.js**
   - 在 displaySingleStock 函數中調用圖表更新
   - 在 hideResults 函數中清除圖表

## 🎯 使用方式

### 查看圖表

1. 輸入股票代號（例如：2330）
2. 點擊「分析」按鈕
3. 向下滾動查看「📊 技術圖表」區塊
4. 第一個圖表顯示價格和均線
5. 第二個圖表顯示 KD 指標

### 互動操作

#### 顯示/隱藏線條
- 點擊圖例中的任何項目可切換該線條的顯示狀態
- 例如：點擊「MA144」可隱藏144日均線

#### 查看詳細數值
- 將滑鼠移到圖表上
- 會顯示該日期所有數值的詳細資訊

#### 手機操作
- 單指滑動：查看不同日期
- 雙指縮放：放大/縮小圖表（如支援）

## 🎨 色彩說明

### 價格圖表
- 🔵 **收盤價** - 淺紫色 (#818cf8)，帶漸變填充
- 🟡 **MA5** - 橙色 (#f59e0b) - 情緒線
- 🟢 **MA13** - 綠色 (#10b981) - 方向線
- 🔵 **MA21** - 藍色 (#3b82f6) - 態度線
- 🟣 **MA34** - 紫色 (#8b5cf6) - 趨勢線
- 🔴 **MA55** - 粉色 (#ec4899) - 生命線
- 🔴 **MA144** - 紅色 (#ef4444) - 生死線

### KD 圖表
- 🟢 **K值** - 綠色 (#10b981)
- 🔴 **D值** - 紅色 (#ef4444)
- 🟡 **超買線** - 橙色虛線（80）
- 🔵 **超賣線** - 藍色虛線（20）

## 📊 數據說明

### 顯示範圍
- 預設顯示最近 **30個交易日** 的數據
- 自動過濾週末和假日
- 確保數據連續性

### 數據來源
- 與分析功能使用相同的 Yahoo Finance API
- 即時計算所有技術指標
- 確保圖表與分析結果一致

## 🔧 技術細節

### Chart.js 版本
- 使用 Chart.js v4.4.1
- 通過 CDN 載入，無需本地安裝
- 完整支援所有現代瀏覽器

### 效能優化
- 圖表自動銷毀和重建，避免記憶體洩漏
- 使用 canvas 渲染，效能優異
- 響應式設計，自動調整大小

### 瀏覽器支援
- ✅ Chrome (桌面/手機)
- ✅ Safari (桌面/iOS)
- ✅ Firefox (桌面/手機)
- ✅ Edge (桌面/手機)
- ✅ Samsung Internet

## 📱 手機體驗

### 優化項目
- 圖表高度自動調整
- 觸控友善的互動
- 清晰的字體大小
- 適當的間距設計

### 建議
- 橫向模式查看圖表效果更佳
- WiFi 環境下載入更快
- 可將頁面加入主畫面，像 App 一樣使用

## 🚀 部署說明

### 檔案清單
確保以下檔案都已更新：

```
Irene_tw_stock/
├── index.html          ✅ 已更新（新增 Chart.js CDN 和 canvas）
├── styles.css          ✅ 已更新（新增圖表樣式）
├── app.js             ✅ 已更新（調用圖表函數）
├── analysis.js        ✅ 已更新（提供圖表數據）
├── stockData.js       ⚪ 無需更新
├── charts.js          ✨ 新增檔案
└── public/            ✅ 已同步所有檔案
    ├── index.html
    ├── styles.css
    ├── app.js
    ├── analysis.js
    ├── stockData.js
    └── charts.js
```

### GitHub Pages 部署
所有檔案已準備就緒，可以直接部署：

```powershell
# 如果使用 Git
git add .
git commit -m "新增 Chart.js 圖表功能"
git push

# 或使用 Firebase
.\deploy.ps1
```

## 🎓 學習資源

### Chart.js 官方文件
- 官網: https://www.chartjs.org/
- 範例: https://www.chartjs.org/docs/latest/samples/
- API: https://www.chartjs.org/docs/latest/api/

### 自訂圖表
如果想要修改圖表樣式，可以編輯 `charts.js` 中的選項：

```javascript
// 修改圖表顏色
borderColor: '#your-color'

// 修改圖表高度
aspectRatio: 2  // 數字越大，圖表越矮

// 修改字體大小
font: { size: 12 }
```

## 🐛 疑難排解

### 問題：圖表沒有顯示

**可能原因**：
1. Chart.js CDN 載入失敗
2. 數據不足（少於30天）
3. JavaScript 錯誤

**解決方案**：
1. 檢查網路連線
2. 開啟瀏覽器開發者工具查看錯誤訊息
3. 確認所有 JS 檔案都已正確載入

### 問題：圖表顯示異常

**解決方案**：
1. 清除瀏覽器快取
2. 重新整理頁面
3. 確認使用最新版本的檔案

### 問題：手機上圖表太小

**解決方案**：
1. 嘗試橫向模式
2. 使用雙指縮放
3. 調整 `charts.js` 中的 `aspectRatio` 值

## 📈 未來改進

### 計劃中的功能
- [ ] 成交量圖表
- [ ] MACD 指標
- [ ] RSI 指標
- [ ] 布林通道
- [ ] 自訂時間範圍
- [ ] 圖表匯出功能
- [ ] 多股比較圖表

## 🎉 總結

成功為台股分析工具新增了專業級的圖表功能！

### 主要優勢
- ✅ 視覺化呈現，更容易理解
- ✅ 互動式操作，更好的使用體驗
- ✅ 專業外觀，提升應用質感
- ✅ 手機友善，隨時隨地使用
- ✅ 效能優異，載入快速

---

**更新日期**: 2026-02-03  
**版本**: v1.1.0  
**新增功能**: Chart.js 圖表整合
