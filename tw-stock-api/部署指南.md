# ğŸš€ å¾Œç«¯ API éƒ¨ç½²æŒ‡å—

## ğŸ“‹ å®Œæ•´æ­¥é©Ÿ

### æ­¥é©Ÿ 1: å®‰è£ Node.js ä¾è³´

```powershell
cd "d:\Zyxel\pythonç·´ç¿’\Irene_tw_stock\tw-stock-api"
npm install
```

**é æœŸè¼¸å‡º**ï¼š
```
added 50 packages in 10s
```

### æ­¥é©Ÿ 2: æœ¬åœ°æ¸¬è©¦

```powershell
npm start
```

**é æœŸè¼¸å‡º**ï¼š
```
ğŸš€ API ä¼ºæœå™¨é‹è¡Œåœ¨ http://localhost:3000
ğŸ“Š å¥åº·æª¢æŸ¥: http://localhost:3000/health
```

### æ­¥é©Ÿ 3: æ¸¬è©¦ API

**é–‹å•Ÿæ–°çš„çµ‚ç«¯æ©Ÿ**ï¼Œæ¸¬è©¦ APIï¼š

```powershell
# æ¸¬è©¦å¥åº·æª¢æŸ¥
curl http://localhost:3000/health

# æ¸¬è©¦è‚¡ç¥¨æŸ¥è©¢
curl http://localhost:3000/api/stock/2330
```

**å¦‚æœæˆåŠŸ**ï¼Œæ‚¨æœƒçœ‹åˆ° JSON å›æ‡‰ã€‚

æŒ‰ `Ctrl+C` åœæ­¢ä¼ºæœå™¨ã€‚

### æ­¥é©Ÿ 4: å®‰è£ Vercel CLI

```powershell
npm install -g vercel
```

### æ­¥é©Ÿ 5: ç™»å…¥ Vercel

```powershell
vercel login
```

**æœƒé–‹å•Ÿç€è¦½å™¨**ï¼Œé¸æ“‡ç™»å…¥æ–¹å¼ï¼š
- GitHubï¼ˆæ¨è–¦ï¼‰
- GitLab
- Bitbucket
- Email

### æ­¥é©Ÿ 6: éƒ¨ç½²åˆ° Vercel

```powershell
cd "d:\Zyxel\pythonç·´ç¿’\Irene_tw_stock\tw-stock-api"
vercel
```

**äº’å‹•å¼å•é¡Œ**ï¼š

```
? Set up and deploy "~/tw-stock-api"? [Y/n] 
â†’ è¼¸å…¥ Y

? Which scope do you want to deploy to? 
â†’ é¸æ“‡ä½ çš„å¸³è™Ÿ

? Link to existing project? [y/N] 
â†’ è¼¸å…¥ N

? What's your project's name? 
â†’ è¼¸å…¥ tw-stock-api

? In which directory is your code located? 
â†’ æŒ‰ Enterï¼ˆä½¿ç”¨ ./ï¼‰

? Want to override the settings? [y/N] 
â†’ è¼¸å…¥ N
```

**éƒ¨ç½²ä¸­**ï¼š
```
ğŸ”—  Linked to your-username/tw-stock-api
ğŸ”  Inspect: https://vercel.com/...
âœ…  Production: https://tw-stock-api.vercel.app
```

### æ­¥é©Ÿ 7: æ¸¬è©¦éƒ¨ç½²çš„ API

```powershell
# æ¸¬è©¦å¥åº·æª¢æŸ¥
curl https://tw-stock-api.vercel.app/health

# æ¸¬è©¦è‚¡ç¥¨æŸ¥è©¢
curl https://tw-stock-api.vercel.app/api/stock/2330
```

### æ­¥é©Ÿ 8: ä¿®æ”¹å‰ç«¯ç¨‹å¼ç¢¼

**ç·¨è¼¯ `analysis.js`**ï¼ˆåœ¨ä¸»å°ˆæ¡ˆä¸­ï¼‰ï¼š

åœ¨æª”æ¡ˆé–‹é ­æ·»åŠ ï¼š

```javascript
// API é…ç½®
const USE_BACKEND_API = true; // è¨­ç‚º true ä½¿ç”¨å¾Œç«¯ API
const BACKEND_API_URL = 'https://tw-stock-api.vercel.app'; // ä½ çš„ Vercel ç¶²å€
```

ä¿®æ”¹ `fetchStockDataCore` å‡½æ•¸ï¼š

```javascript
async function fetchStockDataCore(stockCode) {
    // å¦‚æœä½¿ç”¨å¾Œç«¯ API
    if (USE_BACKEND_API) {
        const url = `${BACKEND_API_URL}/api/stock/${stockCode}`;
        const response = await fetch(url);
        
        if (!response.ok) {
            throw new Error(`HTTP ${response.status}`);
        }
        
        const result = await response.json();
        
        if (!result.success) {
            throw new Error(result.error || 'ç²å–æ•¸æ“šå¤±æ•—');
        }
        
        const data = result.data;
        const chartResult = data.chart.result[0];
        const quote = chartResult.indicators.quote[0];
        
        return {
            timestamps: chartResult.timestamp,
            opens: quote.open,
            highs: quote.high,
            lows: quote.low,
            closes: quote.close,
            volumes: quote.volume
        };
    }
    
    // åŸæœ‰çš„ CORS ä»£ç†é‚è¼¯ï¼ˆä½œç‚ºå‚™ç”¨ï¼‰
    // ... ä¿ç•™åŸæœ‰ç¨‹å¼ç¢¼ ...
}
```

### æ­¥é©Ÿ 9: éƒ¨ç½²å‰ç«¯

```powershell
cd "d:\Zyxel\pythonç·´ç¿’\Irene_tw_stock"
git add .
git commit -m "æ•´åˆå¾Œç«¯ API"
git push
```

### æ­¥é©Ÿ 10: æ¸¬è©¦å®Œæ•´æµç¨‹

1. è¨ªå• GitHub Pagesï¼š
   ```
   https://alexliu0914.github.io/tw-stock-analysis/
   ```

2. é–‹å•Ÿé–‹ç™¼è€…å·¥å…·ï¼ˆF12ï¼‰

3. åˆ‡æ›åˆ° Network æ¨™ç±¤

4. è¼¸å…¥è‚¡ç¥¨ä»£è™Ÿåˆ†æ

5. æŸ¥çœ‹ç¶²è·¯è«‹æ±‚ï¼š
   - æ‡‰è©²çœ‹åˆ°è«‹æ±‚åˆ° `tw-stock-api.vercel.app`
   - è€Œä¸æ˜¯ `api.allorigins.win`

6. æŸ¥çœ‹ Consoleï¼š
   - æ‡‰è©²æ²’æœ‰ CORS éŒ¯èª¤
   - æ‡‰è©²çœ‹åˆ°æˆåŠŸçš„æ—¥èªŒ

---

## ğŸ¯ å¿«é€ŸæŒ‡ä»¤ç¸½çµ

### æœ¬åœ°é–‹ç™¼

```powershell
# é€²å…¥å¾Œç«¯ç›®éŒ„
cd "d:\Zyxel\pythonç·´ç¿’\Irene_tw_stock\tw-stock-api"

# å®‰è£ä¾è³´ï¼ˆé¦–æ¬¡ï¼‰
npm install

# å•Ÿå‹•ä¼ºæœå™¨
npm start

# æˆ–é–‹ç™¼æ¨¡å¼ï¼ˆè‡ªå‹•é‡å•Ÿï¼‰
npm run dev
```

### éƒ¨ç½²

```powershell
# éƒ¨ç½²åˆ° Vercelï¼ˆé è¦½ï¼‰
vercel

# éƒ¨ç½²åˆ°ç”Ÿç”¢ç’°å¢ƒ
vercel --prod
```

### æ›´æ–°éƒ¨ç½²

```powershell
# ä¿®æ”¹ç¨‹å¼ç¢¼å¾Œ
cd "d:\Zyxel\pythonç·´ç¿’\Irene_tw_stock\tw-stock-api"
vercel --prod
```

---

## ğŸ” æ•…éšœæ’é™¤

### å•é¡Œ 1: npm install å¤±æ•—

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
```powershell
# æ¸…é™¤å¿«å–
npm cache clean --force

# é‡æ–°å®‰è£
npm install
```

### å•é¡Œ 2: Vercel ç™»å…¥å¤±æ•—

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
```powershell
# ç™»å‡º
vercel logout

# é‡æ–°ç™»å…¥
vercel login
```

### å•é¡Œ 3: éƒ¨ç½²å¾Œ API ç„¡å›æ‡‰

**æª¢æŸ¥**ï¼š
1. è¨ªå• Vercel Dashboard
2. æŸ¥çœ‹ Deployments
3. é»æ“Šæœ€æ–°éƒ¨ç½²
4. æŸ¥çœ‹ Logs

### å•é¡Œ 4: CORS éŒ¯èª¤ä»ç„¶å­˜åœ¨

**æª¢æŸ¥**ï¼š
1. ç¢ºèªå‰ç«¯ç¨‹å¼ç¢¼å·²æ›´æ–°
2. ç¢ºèª `USE_BACKEND_API = true`
3. ç¢ºèª `BACKEND_API_URL` æ­£ç¢º
4. æ¸…é™¤ç€è¦½å™¨å¿«å–

---

## ğŸ“Š éƒ¨ç½²æª¢æŸ¥æ¸…å–®

- [ ] Node.js å·²å®‰è£
- [ ] npm install æˆåŠŸ
- [ ] æœ¬åœ°æ¸¬è©¦é€šé
- [ ] Vercel CLI å·²å®‰è£
- [ ] Vercel ç™»å…¥æˆåŠŸ
- [ ] éƒ¨ç½²æˆåŠŸ
- [ ] API æ¸¬è©¦é€šé
- [ ] å‰ç«¯ç¨‹å¼ç¢¼å·²æ›´æ–°
- [ ] å‰ç«¯å·²éƒ¨ç½²
- [ ] å®Œæ•´æµç¨‹æ¸¬è©¦é€šé

---

## ğŸ‰ å®Œæˆï¼

ç¾åœ¨æ‚¨çš„æ‡‰ç”¨æ¶æ§‹æ˜¯ï¼š

```
å‰ç«¯ (GitHub Pages)
  â†“
å¾Œç«¯ API (Vercel)
  â†“
Yahoo Finance
```

**å„ªå‹¢**ï¼š
- âœ… ç„¡ CORS å•é¡Œ
- âœ… æ›´ç©©å®š
- âœ… æ›´å¿«é€Ÿï¼ˆå¿«å–ï¼‰
- âœ… å®Œå…¨å…è²»

**ä¸‹ä¸€æ­¥**ï¼š
- ç›£æ§ API ä½¿ç”¨æƒ…æ³
- æ ¹æ“šéœ€è¦èª¿æ•´å¿«å–æ™‚é–“
- æ·»åŠ æ›´å¤šåŠŸèƒ½

---

**éœ€è¦å¹«åŠ©ï¼Ÿ** æŸ¥çœ‹ `tw-stock-api/README.md` æˆ–è©¢å•æˆ‘ï¼
